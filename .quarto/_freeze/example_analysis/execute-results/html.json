{
  "hash": "0a71952ebe23997a9bdec6dd314a0c17",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Example Analysis\"\n\nformat: \n    html:\n        bibliography: citation.bib\n        codetools: true\neditor:\n    render-on-save: true\n\ncallout-appearance: simple\n---\n\n\n\n\n<style>\n  .column-page-inset {\n    max-width: 50%; \n    margin-left: 185px;\n  }\n</style>\n\n## Introduction \nI will perform a data analysis on this page using the Swiss dataset in R.\n\n:::{.column-page-inset}\n![A picture of the Swiss landscape [@reichmuth_2016_picture].](Switzerland.jpg)\n:::\n\n## Question\nWhat was the association between standardized socioeconomic indicators and fertility rates across various French-speaking provinces of Switzerland around 1888?\n\n## Intended Audience\nHistorian and lover of Swiss history.\n\n## Data\nThis dataset contains standardized socioeconomic indicators and fertility rates for 47 Swiss French-speaking provinces in about 1888 [@a2024_r]. It has a high research value, as Switzerland experienced a demographic transition in 1988, during which its fertility rates started declining from the levels typical of developing countries [@mosteller1977data].\n\n\n### Data Source\nIt is a built-in dataset in R, and its documentation manual is published by ETH Zurich [@a2024_r].\n\n::: {.callout-note}\nFiles containing compiled socioeconomic data for Switzerland from the years 1887, 1888, 1910, and 1930 are available [here](https://oprdata.princeton.edu/archive/pefp/switz.aspx){.external target=\"_blank\"} for further reference.\n:::\n\n### Data dictionary\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(swiss, class)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Fertility      Agriculture      Examination        Education \n       \"numeric\"        \"numeric\"        \"integer\"        \"integer\" \n        Catholic Infant.Mortality \n       \"numeric\"        \"numeric\" \n```\n\n\n:::\n:::\n\n\n\n|Variable             |Class     |Description|\n|:--------------------|:---------|:-----------|\n|Fertility            |Numeric |Common standardized fertility measure (scaled in [0,100])|\n|Agriculture          |Numeric |Percentage of males employed in agriculture |\n|Examination          |Integer |Percentage of draftees achieving the highest score on the military exam |\n|Education            |Integer |Percentage of draftees with education beyond primary school |\n|Catholic             |Numeric |Percentage of Catholic |\n|Infant.Mortality     |Numeric |Percentage of live births surviving less than one year |\n\n::: {.callout-note}\n1. The variable descriptions are based on the R documentation manual published by ETH Zurich [@a2024_r].\n2. Figures of `Examination` and `Education` are averaged over the years 1887 to 1889 [@a2024_opr]. \n:::\n\n### Data Analysis\nWe firts look at the summary of data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(swiss)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Fertility      Agriculture     Examination      Education    \n Min.   :35.00   Min.   : 1.20   Min.   : 3.00   Min.   : 1.00  \n 1st Qu.:64.70   1st Qu.:35.90   1st Qu.:12.00   1st Qu.: 6.00  \n Median :70.40   Median :54.10   Median :16.00   Median : 8.00  \n Mean   :70.14   Mean   :50.66   Mean   :16.49   Mean   :10.98  \n 3rd Qu.:78.45   3rd Qu.:67.65   3rd Qu.:22.00   3rd Qu.:12.00  \n Max.   :92.50   Max.   :89.70   Max.   :37.00   Max.   :53.00  \n    Catholic       Infant.Mortality\n Min.   :  2.150   Min.   :10.80   \n 1st Qu.:  5.195   1st Qu.:18.15   \n Median : 15.140   Median :20.00   \n Mean   : 41.144   Mean   :19.94   \n 3rd Qu.: 93.125   3rd Qu.:21.70   \n Max.   :100.000   Max.   :26.60   \n```\n\n\n:::\n:::\n\n\n\nWe notice that variables `Agriculture` and `Catholic` had large discrepancies across provinces, while others exhibited less variation.\n\nWe then investigate the association between male agricultural employment levels and fertility.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nsuppressPackageStartupMessages(library(dplyr))\nswiss %>% ggplot(aes(x=Agriculture)) +\n    geom_histogram(bins=15,fill='white',color='black')+\n    labs(x=\"Percentage of males in agriculture\",\n    y=\"Count\",\n    title = \"Histogram of the Percentage of Males Employed in Agriculture\",\n    subtitle = \"The percentage varies significantly across provinces \",\n    caption = \"Plotted by Shengyi Li\")+\n    theme_bw(base_family = \"Times\")+\n  theme(plot.title = element_text(size=15,hjust=0.5),\n  plot.subtitle = element_text(hjust=0.5,size=12.5),\n  axis.title.x = element_text(size=12),\n  axis.title.y = element_text(size=12))\n```\n\n::: {.cell-output-display}\n![](example_analysis_files/figure-html/agriculture_his-1.png){width=672}\n:::\n:::\n\n\n\nDue to the wide range of `Agriculture` and similar frequencies across bins, we divided it into three categories—low, medium, and high—to examine its association with fertility.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncategory_data <- swiss %>% \n  mutate(Agriculture_group = cut(Agriculture,\n                                  breaks = quantile(Agriculture, probs = c(0, 1/3, 2/3, 1)),\n                                  labels = c(\"Low\", \"Medium\",\"High\"), \n                                  include.lowest = TRUE))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncategory_data %>% ggplot(aes(x=Agriculture_group,y=Fertility))+\n  geom_boxplot()+\n  labs(x = \"Groups by percentage of males in agriculture\", \n       y = \"Fertility rate\", \n       color = \"Agriculture_group\",\n       title = \"Boxplot of fertility rates by different agricultural employment levels\",\n       subtitle = \"Sistributions of fertility rates among the three groups are similar\",\n    caption = \"Plotted by Shengyi Li\")+\n  theme_bw(base_family = \"Times\")+\n  theme(plot.title = element_text(size=15,hjust=0.5),\n  plot.subtitle = element_text(hjust=0.5,size=12.5),\n  axis.title.x = element_text(size=12),\n  axis.title.y = element_text(size=12))\n```\n\n::: {.cell-output-display}\n![](example_analysis_files/figure-html/agriculture_fertility_boxplot-1.png){width=672}\n:::\n:::\n\n\n\nAs the percentage of males employed in agriculture increases, the mean fertility rate remains relatively stable; however, both the first quartile (Q1) and third quartile (Q3) within each group show a gradual increase. And outliers are more evident in the group with a low percentage of males employed in agriculture.\n\nWe also examine how the percentage of males employed in agriculture affects the average infant mortality rate.\n\n\n\n::: {.cell .column-margin}\n\n```{.r .cell-code}\nknitr::kable(\ncategory_data %>% group_by(Agriculture_group) %>%\n  summarize(Mean_infant_mortality = round(mean(Infant.Mortality),2)) %>%\n  rename(Ag_group=Agriculture_group)%>%\n  arrange(desc(Mean_infant_mortality)))\n```\n\n::: {.cell-output-display}\n\n\n|Ag_group | Mean_infant_mortality|\n|:--------|---------------------:|\n|Low      |                 20.04|\n|Medium   |                 19.91|\n|High     |                 19.87|\n\n\n:::\n:::\n\n\n\nWe notice that mean infant mortality was fairly similar between different agriculture groups (abbreviated as Ag_group in the table). It follows that the percentage of males in agriculture had few influences on infant mortality on average.\n\nWe then investigate the association between education levels and examination performance with fertility in different agriculture groups.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncategory_data %>% \n  ggplot(aes(x=Education,y=Fertility,color=Examination))+\n  geom_point(size=3)+\n  facet_wrap(vars(Agriculture_group))+\n  scale_color_gradient(low = \"lightblue\", high = \"darkblue\")+\n  labs(y=\"Fertility measure\",\n  title = 'Scatter plot of Fertility vs Education by agriculture groups,  \\n Colored by Examination performance',\n  subtitle=\"Fertility rate is negatively correlated with education level and examination performance\",\n  caption = \"Plotted by Shengyi Li\")+\n  theme_bw(base_family = \"Times\")+\n  theme(plot.title = element_text(size=15,hjust=0.5),\n  plot.subtitle = element_text(hjust=0.5,size=12.5),\n  axis.title.x = element_text(size=12.5),\n  axis.title.y = element_text(size=12.5))\n```\n\n::: {.cell-output-display}\n![](example_analysis_files/figure-html/Edu_Fer-1.png){width=672}\n:::\n:::\n\n\n\nWe observe that, across all provinces, fertility rates are generally above 50, while the percentages of education are typically below 20, and the proportion of high scores on exams is usually under 35. Additionally, provinces with lower education levels tend to perform worse on examinations and exhibit higher fertility rates. In groups with low percentages of males employed in agriculture, draftees are more likely to achieve the highest scores on the military exam.\n\n## Summary\n1. In 1988, the percentage of Swiss males employed in agriculture varied significantly across provinces, generally ranging between 20% and 70%.\n2. This percentage had minimal impact on the average infant mortality and fertility rates; however, the first and third quartiles of fertility rates showed a gradual increase as this percentage rose.\n3. Educated male percentages were positively correlated with draftees' performance on the military exam, and these two are negatively correlated with fertility rates.\n4. Draftees from provinces with lower percentages of males in agriculture tended to perform better on the military exam.\n\n## Function used\n`dplyr` package: `mutate()`, `group_by()`, `summarize()`, `arrange()`, `desc()`, and `rename()`\n\n`ggplot2` package: `ggplot()`, `geom_point()`, `geom_histogram()`, `geom_boxplot()`, and `facet_wrap()`",
    "supporting": [
      "example_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}